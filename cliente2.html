<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Cliente 2 - Lectura S3</title>
</head>
<body>

<h2>Cliente 2 â€“ Solo Lectura (consume S3)</h2>

<button onclick="getActivos()">Ver Activos</button>
<button onclick="getBaselines()">Ver Baselines</button>

<pre id="out"></pre>

<script>
let TOKEN = null;

async function loginAndStore() {
    try {
        const res = await fetch("http://localhost:4001/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ user: "admin", pass: "admin123" })
        });
        const data = await res.json();
        if (data.token) { TOKEN = data.token; alert("Token obtenido OK"); }
        else alert("No se obtuvo token: " + JSON.stringify(data));
    } catch (err) {
        console.error("LOGIN CLIENTE2 ERROR:", err);
        alert("Error login cliente2: " + err);
    }
}

async function getActivos() {
    try {
        if (!TOKEN) await loginAndStore();
        const res = await fetch("http://localhost:4003/inventory", {
            headers: { Authorization: TOKEN }
        });
        const data = await res.json();
        document.getElementById("out").innerText = JSON.stringify(data, null, 2);
    } catch (err) {
        console.error("ERROR GET ACTIVOS:", err);
        alert("Error: " + err);
    }
}

async function getBaselines() {
    try {
        if (!TOKEN) await loginAndStore();
        const res = await fetch("http://localhost:4003/baselines", {
            headers: { Authorization: TOKEN }
        });
        const data = await res.json();
        document.getElementById("out").innerText = JSON.stringify(data, null, 2);
    } catch (err) {
        console.error("ERROR GET BASELINES:", err);
        alert("Error: " + err);
    }
}
</script>

</body>
</html>
